<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Episodes â€¢ Travel & Ask</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/site.css">
</head>
<body>
  <nav class="nav">
    <div class="container nav-inner">
      <div class="brand">
        <div class="logo"><img src="/assets/logo.png" alt="Travel &amp; Ask logo" onerror="this.src='/assets/logo.svg'"></div>
        <div class="brand-name"><span class="accent">Travel</span> &amp; Ask</div>
      </div>
      <div class="links">
        <a href="/">Home</a>
        <a href="/about/">About</a>
        <a href="/feature/">Feature Business</a>
      </div>
    </div>
  </nav>

  <main>
    <section class="section">
      <div class="container">
        <h1 class="section-title">Episodes</h1>
        <div class="grid cols-3" id="episodes-list"></div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <small>&copy; <span id="y"></span> Travel &amp; Ask</small>
    </div>
  </footer>

  <script>document.getElementById('y').textContent = new Date().getFullYear()</script>
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';
    const firebaseConfig = {"projectId":"studio-6465048620-21f78","appId":"1:479548757971:web:6c8fd092f8c2e983c24126","apiKey":"AIzaSyDMe0ExQbmfplEAlcGfwZzFETj4tU6TkNw","authDomain":"studio-6465048620-21f78.firebaseapp.com","measurementId":"","messagingSenderId":"479548757971"};
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let placeholders = {};
    async function loadEpisodes(){
      const fallback=[{title:'Episode',description:'Coming soon', thumbnail:''}];
      try {
        const res = await fetch('/SRC/lib/placeholder-images.json');
        if (res.ok) {
          const j = await res.json();
          j.placeholderImages.forEach(p => placeholders[p.id] = p.imageUrl);
        }
      } catch {}
      try{
        const snap=await getDocs(collection(db,'episodes'))
        const items=[];snap.forEach(d=>{const x=d.data();items.push({id:d.id,title:x.title||[x.city,x.state].filter(Boolean).join(', '),description:x.description||x.summary||'',thumbnail:x.thumbnail||placeholders[x.imageId]||placeholders['world-map']||''})});
        render(items.length?items:fallback)
      }catch(e){render(fallback)}
    }
    function render(items){
      const el=document.getElementById('episodes-list');el.innerHTML='';
      items.forEach(it=>{
        const card=document.createElement('div');card.className='card';
        if (it.thumbnail) { const img=document.createElement('img'); img.className='card-img'; img.src=it.thumbnail; img.alt=it.title; card.appendChild(img); }
        const a=document.createElement('a'); a.className='card-body'; a.href=`/episodes/view.html?id=${encodeURIComponent(it.id||'')}`;
        const h=document.createElement('h3');h.textContent=it.title;const p=document.createElement('p');p.textContent=it.description;
        a.appendChild(h); a.appendChild(p); card.appendChild(a);
        el.appendChild(card)
      })
    }
    loadEpisodes()
  </script>
</body>
</html>